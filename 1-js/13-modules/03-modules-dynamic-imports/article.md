# åŠ¨æ€å¯¼å…¥

æˆ‘ä»¬åœ¨å‰é¢ç« èŠ‚ä¸­ä»‹ç»çš„å¯¼å‡ºå’Œå¯¼å…¥è¯­å¥ç§°ä¸ºâ€œé™æ€â€å¯¼å…¥ã€‚è¯­æ³•éå¸¸ç®€å•ä¸”ä¸¥æ ¼ã€‚

é¦–å…ˆï¼Œæˆ‘ä»¬ä¸èƒ½åŠ¨æ€ç”Ÿæˆ `import` çš„ä»»ä½•å‚æ•°ã€‚

æ¨¡å—è·¯å¾„å¿…é¡»æ˜¯åŸå§‹ç±»å‹å­—ç¬¦ä¸²ï¼Œä¸èƒ½æ˜¯å‡½æ•°è°ƒç”¨ï¼Œä¸‹é¢è¿™æ ·çš„ `import` è¡Œä¸é€šï¼š

```js
import ... from *!*getModuleName()*/!*; // Error, only from "string" is allowed
```

å…¶æ¬¡ï¼Œæˆ‘ä»¬æ— æ³•æ ¹æ®æ¡ä»¶æˆ–è€…åœ¨è¿è¡Œæ—¶å¯¼å…¥ï¼š

```js
if(...) {
  import ...; // Error, not allowed!
}

{
  import ...; // Error, we can't put import in any block
}
```

è¿™æ˜¯å› ä¸º `import`/`export` æ—¨åœ¨æä¾›ä»£ç ç»“æ„çš„ä¸»å¹²ã€‚è¿™æ˜¯éå¸¸å¥½çš„äº‹å„¿ï¼Œå› ä¸ºè¿™æ ·ä¾¿äºåˆ†æä»£ç ç»“æ„ï¼Œå¯ä»¥æ”¶é›†æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ç‰¹æ®Šå·¥å…·å°†æ”¶é›†çš„æ¨¡å—æ‰“åŒ…åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼Œå¯ä»¥åˆ é™¤æœªä½¿ç”¨çš„å¯¼å‡ºï¼ˆ"tree-shaken"ï¼‰ã€‚è¿™äº›åªæœ‰åœ¨ `import`/`export` ç»“æ„ç®€å•ä¸”å›ºå®šçš„æƒ…å†µä¸‹æ‰èƒ½å¤Ÿå®ç°ã€‚

ä½†æ˜¯ï¼Œæˆ‘ä»¬å¦‚ä½•æ‰èƒ½åŠ¨æ€åœ°æŒ‰éœ€å¯¼å…¥æ¨¡å—å‘¢ï¼Ÿ

## import() è¡¨è¾¾å¼

`import(module)` è¡¨è¾¾å¼åŠ è½½æ¨¡å—å¹¶è¿”å›ä¸€ä¸ª promiseï¼Œè¯¥ promise resolve ä¸ºä¸€ä¸ªåŒ…å«å…¶æ‰€æœ‰å¯¼å‡ºçš„æ¨¡å—å¯¹è±¡ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»æ„ä½ç½®è°ƒç”¨è¿™ä¸ªè¡¨è¾¾å¼ã€‚

æˆ‘ä»¬å¯ä»¥åœ¨ä»£ç ä¸­çš„ä»»æ„ä½ç½®åŠ¨æ€åœ°ä½¿ç”¨å®ƒã€‚ä¾‹å¦‚ï¼š

```js
let modulePath = prompt("Which module to load?");

import(modulePath)
  .then(obj => <module object>)
  .catch(err => <loading error, e.g. if no such module>)
```

æˆ–è€…ï¼Œå¦‚æœåœ¨å¼‚æ­¥å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `let module = await import(modulePath)`ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æœ‰ä»¥ä¸‹æ¨¡å— `say.js`ï¼š

```js
// ğŸ“ say.js
export function hi() {
  alert(`Hello`);
}

export function bye() {
  alert(`Bye`);
}
```

â€¦â€¦é‚£ä¹ˆï¼Œå¯ä»¥åƒä¸‹é¢è¿™æ ·è¿›è¡ŒåŠ¨æ€å¯¼å…¥ï¼š

```js
let {hi, bye} = await import('./say.js');

hi();
bye();
```

æˆ–è€…ï¼Œå¦‚æœ `say.js` æœ‰é»˜è®¤çš„å¯¼å‡ºï¼š

```js
// ğŸ“ say.js
export default function() {
  alert("Module loaded (export default)!");
}
```

â€¦â€¦é‚£ä¹ˆï¼Œä¸ºäº†è®¿é—®å®ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¨¡å—å¯¹è±¡çš„ `default` å±æ€§ï¼š

```js
let obj = await import('./say.js');
let say = obj.default;
// or, in one line: let {default: say} = await import('./say.js');

say();
```

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼š

[codetabs src="say" current="index.html"]

```smart
åŠ¨æ€å¯¼å…¥åœ¨å¸¸è§„è„šæœ¬ä¸­å·¥ä½œæ—¶ï¼Œå®ƒä»¬ä¸éœ€è¦ `script type="module"`.
```

```smart
å°½ç®¡ `import()` çœ‹èµ·æ¥åƒä¸€ä¸ªå‡½æ•°è°ƒç”¨ï¼Œä½†å®ƒåªæ˜¯ä¸€ç§ç‰¹æ®Šè¯­æ³•ï¼Œåªæ˜¯æ°å¥½ä½¿ç”¨äº†æ‹¬å·ï¼ˆç±»ä¼¼äº `super()`ï¼‰ã€‚

å› æ­¤ï¼Œæˆ‘ä»¬ä¸èƒ½å°† `import` å¤åˆ¶åˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œæˆ–è€…å¯¹å…¶ä½¿ç”¨ `call/apply`ã€‚å› ä¸ºå®ƒä¸æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚
```
