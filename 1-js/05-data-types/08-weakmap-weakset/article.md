# WeakMap and WeakSetï¼ˆå¼±æ˜ å°„å’Œå¼±é›†åˆï¼‰

æˆ‘ä»¬ä»å‰é¢çš„ <info:garbage-collection> ç« èŠ‚ä¸­çŸ¥é“ï¼ŒJavaScript å¼•æ“åœ¨å€¼å¯è®¿é—®ï¼ˆå¹¶å¯èƒ½è¢«ä½¿ç”¨ï¼‰æ—¶å°†å…¶å­˜å‚¨åœ¨å†…å­˜ä¸­ã€‚

ä¾‹å¦‚:
```js
let john = { name: "John" };

// è¯¥å¯¹è±¡èƒ½è¢«è®¿é—®ï¼Œjohn æ˜¯å®ƒçš„å¼•ç”¨

// è¦†ç›–å¼•ç”¨
john = null;

*!*
// è¯¥å¯¹è±¡å°†ä¼šè¢«ä»å†…å­˜ä¸­æ¸…é™¤
*/!*
```

é€šå¸¸ï¼Œå½“å¯¹è±¡ã€æ•°ç»„è¿™ç±»æ•°æ®ç»“æ„åœ¨å†…å­˜ä¸­æ—¶ï¼Œå®ƒä»¬çš„å­å…ƒç´ ï¼Œå¦‚å¯¹è±¡çš„å±æ€§ã€æ•°ç»„çš„å…ƒç´ éƒ½æ˜¯å¯ä»¥è®¿é—®çš„ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæŠŠä¸€ä¸ªå¯¹è±¡æ”¾å…¥åˆ°æ•°ç»„ä¸­ï¼Œé‚£ä¹ˆåªè¦è¿™ä¸ªæ•°ç»„å­˜åœ¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ä¹Ÿå°±å­˜åœ¨ï¼Œå³ä½¿æ²¡æœ‰å…¶ä»–å¯¹è¯¥å¯¹è±¡çš„å¼•ç”¨ã€‚

å°±åƒè¿™æ ·:

```js
let john = { name: "John" };

let array = [ john ];

john = null; // è¦†ç›–å¼•ç”¨

*!*
// john è¢«å­˜å‚¨åœ¨æ•°ç»„é‡Œ, æ‰€ä»¥å®ƒä¸ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶
// æˆ‘ä»¬å¯ä»¥é€šè¿‡ array[0] æ¥è·å–å®ƒ
*/!*
```

ç±»ä¼¼çš„ï¼Œå¦‚æœæˆ‘ä»¬ä½¿ç”¨å¯¹è±¡ä½œä¸ºå¸¸è§„ `Map` çš„é”®ï¼Œé‚£ä¹ˆå½“ `Map` å­˜åœ¨æ—¶ï¼Œè¯¥å¯¹è±¡ä¹Ÿå°†å­˜åœ¨ã€‚å®ƒä¼šå ç”¨å†…å­˜ï¼Œå¹¶ä¸”åº”è¯¥ä¸ä¼šè¢«ï¼ˆåƒåœ¾å›æ”¶æœºåˆ¶ï¼‰å›æ”¶ã€‚

ä¾‹å¦‚ï¼š

```js
let john = { name: "John" };

let map = new Map();
map.set(john, "...");

john = null; // è¦†ç›–å¼•ç”¨

*!*
// john è¢«å­˜å‚¨åœ¨ map ä¸­ï¼Œ
// æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ map.keys() æ¥è·å–å®ƒ
*/!*
```

`WeakMap` åœ¨è¿™æ–¹é¢æœ‰ç€æ ¹æœ¬ä¸Šçš„ä¸åŒã€‚å®ƒä¸ä¼šé˜»æ­¢åƒåœ¾å›æ”¶æœºåˆ¶å¯¹ä½œä¸ºé”®çš„å¯¹è±¡ï¼ˆkey objectï¼‰çš„å›æ”¶ã€‚

è®©æˆ‘ä»¬é€šè¿‡ä¾‹å­æ¥çœ‹çœ‹è¿™æŒ‡çš„åˆ°åº•æ˜¯ä»€ä¹ˆã€‚

## WeakMap

`WeakMap` å’Œ `Map` çš„ç¬¬ä¸€ä¸ªä¸åŒç‚¹å°±æ˜¯ï¼Œ`WeakMap` çš„é”®å¿…é¡»æ˜¯å¯¹è±¡ï¼Œä¸èƒ½æ˜¯åŸå§‹å€¼ï¼š

```js run
let weakMap = new WeakMap();

let obj = {};

weakMap.set(obj, "ok"); // æ­£å¸¸å·¥ä½œï¼ˆä»¥å¯¹è±¡ä½œä¸ºé”®ï¼‰

*!*
// ä¸èƒ½ä½¿ç”¨å­—ç¬¦ä¸²ä½œä¸ºé”®
weakMap.set("test", "Whoops"); // Errorï¼Œå› ä¸º "test" ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡
*/!*
```

ç°åœ¨ï¼Œå¦‚æœæˆ‘ä»¬åœ¨ weakMap ä¸­ä½¿ç”¨ä¸€ä¸ªå¯¹è±¡ä½œä¸ºé”®ï¼Œå¹¶ä¸”æ²¡æœ‰å…¶ä»–å¯¹è¿™ä¸ªå¯¹è±¡çš„å¼•ç”¨ â€” è¯¥å¯¹è±¡å°†ä¼šè¢«ä»å†…å­˜ï¼ˆå’Œmapï¼‰ä¸­è‡ªåŠ¨æ¸…é™¤ã€‚

```js
let john = { name: "John" };

let weakMap = new WeakMap();
weakMap.set(john, "...");

john = null; // è¦†ç›–å¼•ç”¨

// john è¢«ä»å†…å­˜ä¸­åˆ é™¤äº†ï¼
```

ä¸ä¸Šé¢å¸¸è§„çš„ `Map` çš„ä¾‹å­ç›¸æ¯”ï¼Œç°åœ¨å¦‚æœ `john` ä»…ä»…æ˜¯ä½œä¸º `WeakMap` çš„é”®è€Œå­˜åœ¨ â€” å®ƒå°†ä¼šè¢«ä» mapï¼ˆå’Œå†…å­˜ï¼‰ä¸­è‡ªåŠ¨åˆ é™¤ã€‚

`WeakMap` ä¸æ”¯æŒè¿­ä»£ä»¥åŠ `keys()`ï¼Œ`values()` å’Œ `entries()` æ–¹æ³•ã€‚æ‰€ä»¥æ²¡æœ‰åŠæ³•è·å– `WeakMap` çš„æ‰€æœ‰é”®æˆ–å€¼ã€‚

`WeakMap` åªæœ‰ä»¥ä¸‹çš„æ–¹æ³•ï¼š

- `weakMap.get(key)`
- `weakMap.set(key, value)`
- `weakMap.delete(key)`
- `weakMap.has(key)`

ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§é™åˆ¶å‘¢ï¼Ÿè¿™æ˜¯æŠ€æœ¯çš„åŸå› ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸¢å¤±äº†å…¶å®ƒæ‰€æœ‰å¼•ç”¨ï¼ˆå°±åƒä¸Šé¢ç¤ºä¾‹ä¸­çš„ `john`ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°±ä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶è‡ªåŠ¨å›æ”¶ã€‚ä½†æ˜¯åœ¨ä»æŠ€æœ¯çš„è§’åº¦å¹¶ä¸èƒ½å‡†ç¡®çŸ¥é“ **ä½•æ—¶ä¼šè¢«å›æ”¶**ã€‚

è¿™äº›éƒ½æ˜¯ç”± JavaScript å¼•æ“å†³å®šçš„ã€‚JavaScript å¼•æ“å¯èƒ½ä¼šé€‰æ‹©ç«‹å³æ‰§è¡Œå†…å­˜æ¸…ç†ï¼Œå¦‚æœç°åœ¨æ­£åœ¨å‘ç”Ÿå¾ˆå¤šåˆ é™¤æ“ä½œï¼Œé‚£ä¹ˆ JavaScript å¼•æ“å¯èƒ½å°±ä¼šé€‰æ‹©ç­‰ä¸€ç­‰ï¼Œç¨åå†è¿›è¡Œå†…å­˜æ¸…ç†ã€‚å› æ­¤ï¼Œä»æŠ€æœ¯ä¸Šè®²ï¼Œ`WeakMap` çš„å½“å‰å…ƒç´ çš„æ•°é‡æ˜¯æœªçŸ¥çš„ã€‚JavaScript å¼•æ“å¯èƒ½æ¸…ç†äº†å…¶ä¸­çš„åƒåœ¾ï¼Œå¯èƒ½æ²¡æ¸…ç†ï¼Œä¹Ÿå¯èƒ½æ¸…ç†äº†ä¸€éƒ¨åˆ†ã€‚å› æ­¤ï¼Œæš‚ä¸æ”¯æŒè®¿é—® `WeakMap` çš„æ‰€æœ‰é”®/å€¼çš„æ–¹æ³•ã€‚

é‚£ä¹ˆï¼Œåœ¨å“ªé‡Œæˆ‘ä»¬ä¼šéœ€è¦è¿™æ ·çš„æ•°æ®ç»“æ„å‘¢ï¼Ÿ

## ä½¿ç”¨æ¡ˆä¾‹ï¼šé¢å¤–çš„æ•°æ®

`WeakMap` çš„ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ **é¢å¤–æ•°æ®çš„å­˜å‚¨**ã€‚

å‡å¦‚æˆ‘ä»¬æ­£åœ¨å¤„ç†ä¸€ä¸ªâ€œå±äºâ€å¦ä¸€ä¸ªä»£ç çš„ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå¯èƒ½æ˜¯ç¬¬ä¸‰æ–¹åº“ï¼Œå¹¶æƒ³å­˜å‚¨ä¸€äº›ä¸ä¹‹ç›¸å…³çš„æ•°æ®ï¼Œé‚£ä¹ˆè¿™äº›æ•°æ®å°±åº”è¯¥ä¸è¿™ä¸ªå¯¹è±¡å…±å­˜äº¡ â€” è¿™æ—¶å€™ `WeakMap` æ­£æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„åˆ©å™¨ã€‚

æˆ‘ä»¬å°†è¿™äº›æ•°æ®æ”¾åˆ° `WeakMap` ä¸­ï¼Œå¹¶ä½¿ç”¨è¯¥å¯¹è±¡ä½œä¸ºè¿™äº›æ•°æ®çš„é”®ï¼Œé‚£ä¹ˆå½“è¯¥å¯¹è±¡è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶åï¼Œè¿™äº›æ•°æ®ä¹Ÿä¼šè¢«è‡ªåŠ¨æ¸…é™¤ã€‚

```js
weakMap.set(john, "secret documents");
// å¦‚æœ john æ¶ˆå¤±ï¼Œsecret documents å°†ä¼šè¢«è‡ªåŠ¨æ¸…é™¤
```

è®©æˆ‘ä»¬æ¥çœ‹ä¸€ä¸ªä¾‹å­ã€‚

ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ç”¨äºå¤„ç†ç”¨æˆ·è®¿é—®è®¡æ•°çš„ä»£ç ã€‚æ”¶é›†åˆ°çš„ä¿¡æ¯è¢«å­˜å‚¨åœ¨ map ä¸­ï¼šä¸€ä¸ªç”¨æˆ·å¯¹è±¡ä½œä¸ºé”®ï¼Œå…¶è®¿é—®æ¬¡æ•°ä¸ºå€¼ã€‚å½“ä¸€ä¸ªç”¨æˆ·ç¦»å¼€æ—¶ï¼ˆè¯¥ç”¨æˆ·å¯¹è±¡å°†è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶ï¼‰ï¼Œè¿™æ—¶æˆ‘ä»¬å°±ä¸å†éœ€è¦ä»–çš„è®¿é—®æ¬¡æ•°äº†ã€‚

ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ `Map` çš„è®¡æ•°å‡½æ•°çš„ä¾‹å­ï¼š

```js
// ğŸ“ visitsCount.js
let visitsCountMap = new Map(); // map: user => visits count

// é€’å¢ç”¨æˆ·æ¥è®¿æ¬¡æ•°
function countUser(user) {
  let count = visitsCountMap.get(user) || 0;
  visitsCountMap.set(user, count + 1);
}
```

ä¸‹é¢æ˜¯å…¶ä»–éƒ¨åˆ†çš„ä»£ç ï¼Œå¯èƒ½æ˜¯ä½¿ç”¨å®ƒçš„å…¶å®ƒä»£ç ï¼š

```js
// ğŸ“ main.js
let john = { name: "John" };

countUser(john); // count his visits

// ä¸ä¹…ä¹‹åï¼Œjohn ç¦»å¼€äº†
john = null;
```

ç°åœ¨ `john` è¿™ä¸ªå¯¹è±¡åº”è¯¥è¢«å›æ”¶ï¼Œä½†å› ä¸ºä»–çš„é”®è¿˜åœ¨`visitsCountMap` ä¸­å¯¼è‡´å®ƒä¾ç„¶ç•™å­˜åœ¨å†…å­˜ä¸­ã€‚

å¯¹æˆ‘ä»¬ç§»é™¤æŸä¸ªç”¨æˆ·çš„æ—¶å€™éœ€è¦æ¸…ç† `visitsCountMap` ï¼Œ å¦åˆ™å®ƒä»¬ä¼šåœ¨å†…å­˜ä¸­æ— é™å¢åŠ ã€‚è¿™ç§æ¸…ç†åœ¨å¤æ‚çš„æ¶æ„ç³»ç»Ÿä¸­å°†ä¼šæ˜¯å¾ˆä¹å‘³çš„ä»»åŠ¡ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨ `WeakMap` æ¥é¿å…è¿™æ ·çš„é—®é¢˜ï¼š

```js
// ğŸ“ visitsCount.js
let visitsCountMap = new WeakMap(); // weakmap: user => visits count

// é€’å¢æ¸¸å®¢æ¥è®¿æ¬¡æ•°
function countUser(user) {
  let count = visitsCountMap.get(user) || 0;
  visitsCountMap.set(user, count + 1);
}
```

ç°åœ¨æˆ‘ä»¬ä¸éœ€è¦å»æ¸…ç†`visitsCountMap`äº†ã€‚`WeakMap` é‡Œçš„ `john` å¯¹è±¡ä»¥åŠå®ƒæºå¸¦çš„ä¿¡æ¯å°†ä¼šè¢«å›æ”¶ï¼ˆæ¸…é™¤ï¼‰ï¼Œå…¶å®ƒæ‰€æœ‰é€”å¾„éƒ½ä¸èƒ½è®¿é—®å®ƒé™¤éæ˜¯ä½œä¸º `WeakMap` çš„é”®ã€‚

## ä½¿ç”¨æ¡ˆä¾‹: ç¼“å­˜

å¦å¤–ä¸€ä¸ªå¾ˆæ™®éçš„ä¾‹å­æ˜¯ç¼“å­˜: å½“å‡½æ•°çš„ç»“æœéœ€è¦è¢«è®°ä½ï¼ˆâ€œç¼“å­˜â€ï¼‰ï¼Œè¿™æ ·åœ¨åç»­çš„åŒä¸€ä¸ªå¯¹è±¡è°ƒç”¨çš„æ—¶å€™å¯ä»¥é‡ç”¨è¯¥è¢«ç¼“å­˜çš„ç»“æœã€‚

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ `Map` æ¥å­˜å‚¨ç»“æœï¼Œå°±åƒè¿™æ ·ï¼š

```js run
// ğŸ“ cache.js
let cache = new Map();

// è®¡ç®—å¹¶è®°ä½ç»“æœ
function process(obj) {
  if (!cache.has(obj)) {
    let result = /* è®¡ç®— obj å€¼çš„ç»“æœ */ obj;

    cache.set(obj, result);
  }

  return cache.get(obj);
}

*!*
// ç°åœ¨æˆ‘ä»¬åœ¨å…¶å®ƒæ–‡ä»¶ä¸­ä½¿ç”¨ process() ï¼š
*/!*

// ğŸ“ main.js
let obj = {/* å‡è®¾æœ‰ä¸ªå¯¹è±¡ */};

let result1 = process(obj); // è®¡ç®—ä¸­...

// ...ä¹‹å, æ¥è‡ªå¦å¤–ä¸€ä¸ªåœ°æ–¹çš„ä»£ç ...
let result2 = process(obj); // remembered result taken from cache

// ...ä¹‹å, æ”¹å¯¹è±¡ä¸å†éœ€è¦ä½¿ç”¨æ—¶:
obj = null;

alert(cache.size); // 1 (å•Š! è¯¥å¯¹è±¡ä¾ç„¶åœ¨ cache ä¸­, å¹¶å æ®ç€å†…å­˜ï¼)
```

å¯¹äºåŒä¸€ä¸ªå¯¹è±¡å¤šæ¬¡è°ƒç”¨ï¼Œå®ƒåªæ˜¯è®¡ç®—ç¬¬ä¸€æ¬¡ï¼Œä¹‹åç›´æ¥ä» `cache` ä¸­è·å–ï¼Œè¿™æ ·åšçš„ç¼ºç‚¹æ˜¯å½“æˆ‘ä»¬ä¸å†éœ€è¦è¿™ä¸ªå¯¹è±¡çš„æ—¶å€™éœ€è¦æ¸…ç† `cache`

å¦‚æœæˆ‘ä»¬ç”¨ `WeakMap` ä»£æ›¿`Map`è¿™ä¸ªé—®é¢˜ä¾¿ä¼šæ¶ˆå¤±ï¼š ç¼“å­˜çš„ç»“æœåœ¨è¯¥å¯¹è±¡èƒŒå›æ”¶ä¹‹åä¼šè‡ªåŠ¨ä»å†…å­˜ä¸­é‡Šæ”¾ã€‚

```js run
// ğŸ“ cache.js
*!*
let cache = new WeakMap();
*/!*

// è®¡ç®—å¹¶è®°ç»“æœ
function process(obj) {
  if (!cache.has(obj)) {
    let result = /* è®¡ç®— obj ä¹‹åå¾—å‡ºçš„ç»“æœ */ obj;

    cache.set(obj, result);
  }

  return cache.get(obj);
}

// ğŸ“ main.js
let obj = {/* some object */};

let result1 = process(obj);
let result2 = process(obj);

// ...ä¹‹å, å½“è¯¥å¯¹è±¡ä¸å†éœ€è¦çš„æ—¶å€™:
obj = null;

// ä¸èƒ½ä½¿ç”¨ cache.size, å› ä¸ºå®ƒæ˜¯ä¸€ä¸ª WeakMap,
// è¦ä¹ˆæ˜¯ 0 æˆ–è€… å¾ˆå¿«å˜æˆ 0
// å½“ obj è¢«å›æ”¶æ—¶, ç¼“å­˜çš„æ•°æ®ä¹Ÿä¼šè¢«æ¸…é™¤
```

## WeakSet

`WeakSet` çš„ä½œç”¨ç±»ä¼¼:

- å®ƒè·Ÿ `Set` ç±»ä¼¼, ä½†æ˜¯æˆ‘ä»¬åªèƒ½æ·»åŠ å¯¹è±¡åˆ° `WeakSet` (éåŸå§‹å€¼)ä¸­ã€‚
- æŸä¸ªå¯¹è±¡åªæœ‰åœ¨å…¶å®ƒä»»ä½•åœ°æ–¹éƒ½èƒ½è®¿é—®çš„æ—¶å€™æ‰èƒ½ç•™åœ¨ set é‡Œã€‚
- è·Ÿ `Set` ä¸€æ ·, `WeakSet` æ”¯æŒ `add`, `has` and `delete` ç­‰æ–¹æ³•, ä½†ä¸æ”¯æŒ `size`, `keys()` å¹¶ä¸”æ²¡æœ‰è¿­ä»£ã€‚
å˜ "å¼±" çš„åŒæ—¶, å®ƒä¹Ÿå¯ä»¥ä½œä¸ºé¢å¤–çš„å­˜å‚¨ç©ºé—´ï¼Œä½†å¹¶éä»»æ„æ•°æ®ï¼Œè€Œæ˜¯é’ˆå¯¹â€œæ˜¯/å¦â€çš„äº‹å®ï¼Œåœ¨ `WeakSet` é‡Œçš„æˆå‘˜ä»£è¡¨ç€å¯¹è±¡é‡Œçš„æŸä¸ªå±æ€§ã€‚
ä¾‹å¦‚, æˆ‘ä»¬å¯ä»¥æ·»åŠ  users åˆ° `WeakSet` é‡Œæ¥è¿½è¸ªè°è®¿é—®äº†æˆ‘ä»¬çš„ç½‘ç«™ï¼š

```js run
let visitedSet = new WeakSet();

let john = { name: "John" };
let pete = { name: "Pete" };
let mary = { name: "Mary" };

visitedSet.add(john); // John visited us
visitedSet.add(pete); // Then Pete
visitedSet.add(john); // John again

// ç°åœ¨ visitedSet æœ‰2ä¸ªç”¨æˆ·

// æ£€æŸ¥ John æ˜¯å¦è®¿é—®è¿‡?
alert(visitedSet.has(john)); // true

// æ£€æŸ¥ Mary æ˜¯å¦è®¿é—®è¿‡?
alert(visitedSet.has(mary)); // false

john = null;

// visitedSet å°†è¢«è‡ªåŠ¨æ¸…ç†
```

 `WeakMap` å’Œ `WeakSet` æœ€å‡ºåçš„é™åˆ¶æ˜¯ä¸èƒ½è¿­ä»£ï¼Œå¹¶ä¸”æ— æ³•è·å–æ‰€æœ‰å½“å‰å†…å®¹ã€‚é‚£æ ·å¯èƒ½ä¼šé€ æˆä¸ä¾¿ï¼Œä½†æ˜¯ä¾æ—§ä¸èƒ½é˜»æ­¢ `WeakMap/WeakSet` å®Œæˆå…¶ä¸»è¦å·¥ä½œ -- æˆä¸ºåœ¨å…¶å®ƒåœ°æ–¹ç®¡ç†æˆ–è€…å­˜å‚¨çš„å¯¹è±¡çš„ â€œé¢å¤–çš„â€ æ•°æ®å­˜å‚¨

## æ€»ç»“

` WeakMap` æ˜¯ç±»ä¼¼äº `Map` çš„é›†åˆï¼Œå®ƒä»…å…è®¸å¯¹è±¡ä½œä¸ºé”®ï¼Œå¹¶åœ¨å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®å®ƒä»¬æ—¶å°†å…¶ä¸å…³è”å€¼ä¸€èµ·åˆ é™¤ã€‚

`WeakSet` æ˜¯ç±»ä¼¼äº`Set`çš„é›†åˆï¼Œå®ƒä»…å­˜å‚¨å¯¹è±¡ï¼Œå¹¶åœ¨å…¶ä»–æ–¹å¼æ— æ³•è®¿é—®å®ƒä»¬æ—¶å°†å…¶åˆ é™¤ã€‚ 

å®ƒä»¬éƒ½ä¸æ”¯æŒå¼•ç”¨æ‰€æœ‰é”®æˆ–å…¶è®¡æ•°çš„æ–¹æ³•å’Œå±æ€§ã€‚ ä»…å…è®¸å•ä¸ªæ“ä½œã€‚

`WeakMap` å’Œ`WeakSet`è¿˜ç”¨ä½œâ€œè¾…åŠ©â€æ•°æ®ç»“æ„ã€‚ ä¸€æ—¦å°†å¯¹è±¡ä»ä¸»å­˜å‚¨å™¨ä¸­åˆ é™¤ï¼Œå¦‚æœä»…å°†å…¶ä½œä¸ºâ€œ WeakMapâ€æˆ–â€œ WeakSetâ€çš„é”®ï¼Œé‚£ä¹ˆåˆ™å°†è‡ªåŠ¨æ¸…é™¤è¯¥å¯¹è±¡ã€‚
